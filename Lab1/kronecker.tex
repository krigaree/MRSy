	\section{Macierze Kroneckera}
	\subsection{Iloczyn Kroneckera}	
		
		Jeżeli \textbf{A} jest macierzą o wymiarze $m \times n$, oraz \textbf{B} jest $p \times q$, to \textbf{iloczynem Kroneckera (iloczynem tensorowym)} $\mathbf{A \otimes B}$ nazywamy macierz blokową $mp \times nq$
		
	$$\mathbf{A \otimes B} = \begin{bmatrix} a_{11} \mathbf{B} & \cdots & a_{1n}\mathbf{B} \\ \vdots & \ddots & \vdots \\ a_{m1} \mathbf{B} & \cdots & a_{mn} \mathbf{B} \end{bmatrix}$$
	
	Z definicji tej wynika, że mnożone macierze \textbf{A} i \textbf{B} mogą być dowolnych rozmiarów.
	
	W ogólności $\mathbf{A \otimes B} \neq \mathbf{B \otimes A}$.
	
		\textbf{Przykład}
	$$\begin{bmatrix}1&2\\3&4\\\end{bmatrix}\otimes {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}={\begin{bmatrix}1\cdot {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}&2\cdot {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}\\3\cdot {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}&4\cdot {\begin{bmatrix}0&5\\6&7\\\end{bmatrix}}\\\end{bmatrix}}={\begin{bmatrix}1\cdot 0&1\cdot 5&2\cdot 0&2\cdot 5\\1\cdot 6&1\cdot 7&2\cdot 6&2\cdot 7\\3\cdot 0&3\cdot 5&4\cdot 0&4\cdot 5\\3\cdot 6&3\cdot 7&4\cdot 6&4\cdot 7\\\end{bmatrix}}={\begin{bmatrix}0&5&0&10\\6&7&12&14\\0&15&0&20\\18&21&24&28\end{bmatrix}}$$
	
	\subsection{Cel ćwiczenia}
	Dla zadanych macierzy A, B, C mieliśmy utworzyć odpowienie macierze przy pomocy iloczynu Kroneckera.
	
		$$A = \begin{bmatrix}2&-1\\-1&2\\\end{bmatrix},  B = \begin{bmatrix}0&-1\\2&3\\\end{bmatrix},  C = \begin{bmatrix}1&1\\1&2\\\end{bmatrix} $$
	
	\subsection{Algorytm}
		Przykłady zostały wykonane dla rzędu macierzy \textbf{n = 6}
		
\begin{samepage}
\begin{Shaded}
\begin{Highlighting}[]
\FunctionTok{clc}\NormalTok{,}\FunctionTok{clear}\NormalTok{;}
        
\NormalTok{A=[}\FloatTok{2}\NormalTok{, -}\FloatTok{1}\NormalTok{;-}\FloatTok{1}\NormalTok{,}\FloatTok{2}\NormalTok{];}
\NormalTok{B=[}\FloatTok{0}\NormalTok{,-}\FloatTok{1}\NormalTok{;}\FloatTok{2}\NormalTok{,}\FloatTok{3}\NormalTok{];}
\NormalTok{C=[}\FloatTok{1}\NormalTok{,}\FloatTok{1}\NormalTok{;}\FloatTok{1}\NormalTok{,}\FloatTok{2}\NormalTok{];}
        
\NormalTok{n=}\FloatTok{input("Enter a number: ")}\NormalTok{;}
        
\NormalTok{E1 = }\FunctionTok{kron}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n),A)}
\end{Highlighting}
\end{Shaded}
\end{samepage}
\begin{samepage}
\begin{verbatim}
## E1 =
## 
##    2  -1   0   0   0   0   0   0   0   0   0   0
##   -1   2   0   0   0   0   0   0   0   0   0   0
##    0   0   2  -1   0   0   0   0   0   0   0   0
##    0   0  -1   2   0   0   0   0   0   0   0   0
##    0   0   0   0   2  -1   0   0   0   0   0   0
##    0   0   0   0  -1   2   0   0   0   0   0   0
##    0   0   0   0   0   0   2  -1   0   0   0   0
##    0   0   0   0   0   0  -1   2   0   0   0   0
##    0   0   0   0   0   0   0   0   2  -1   0   0
##    0   0   0   0   0   0   0   0  -1   2   0   0
##    0   0   0   0   0   0   0   0   0   0   2  -1
##    0   0   0   0   0   0   0   0   0   0  -1   2
\end{verbatim}
\end{samepage}
\newpage
\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{E2 = }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),A)}
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E2 =
## 
##    2  -1   0   0   0   0   0   0   0   0   0   0
##   -1   2   0   0   0   0   0   0   0   0   0   0
##    0   0   4  -2   0   0   0   0   0   0   0   0
##    0   0  -2   4   0   0   0   0   0   0   0   0
##    0   0   0   0   4  -2   0   0   0   0   0   0
##    0   0   0   0  -2   4   0   0   0   0   0   0
##    0   0   0   0   0   0   4  -2   0   0   0   0
##    0   0   0   0   0   0  -2   4   0   0   0   0
##    0   0   0   0   0   0   0   0   4  -2   0   0
##    0   0   0   0   0   0   0   0  -2   4   0   0
##    0   0   0   0   0   0   0   0   0   0   2  -1
##    0   0   0   0   0   0   0   0   0   0  -1   2
\end{verbatim}          
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]

\NormalTok{v = [}\FloatTok{1}\NormalTok{;-}\FloatTok{1}\NormalTok{*}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{));}\FloatTok{1}\NormalTok{];}
	
\NormalTok{E3 = }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{1}\NormalTok{)),}\FloatTok{1}\NormalTok{),B) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{1}\NormalTok{)),-}\FloatTok{1}\NormalTok{),B);}
	\end{Highlighting}
\end{Shaded}                                        
\end{samepage}
                    
\begin{samepage}
\begin{verbatim} 
## E3 =
## 
##    2  -1   0  -1   0   0   0   0   0   0   0   0
##   -1   2   2   3   0   0   0   0   0   0   0   0
##    0  -1  -2   1   0  -1   0   0   0   0   0   0
##    2   3   1  -2   2   3   0   0   0   0   0   0
##    0   0   0  -1  -2   1   0  -1   0   0   0   0
##    0   0   2   3   1  -2   2   3   0   0   0   0
##    0   0   0   0   0  -1  -2   1   0  -1   0   0
##    0   0   0   0   2   3   1  -2   2   3   0   0
##    0   0   0   0   0   0   0  -1  -2   1   0  -1
##    0   0   0   0   0   0   2   3   1  -2   2   3
##    0   0   0   0   0   0   0   0   0  -1   2  -1
##    0   0   0   0   0   0   0   0   2   3  -1   2
\end{verbatim}
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{v = [}\FloatTok{1}\NormalTok{;}\FloatTok{2}\NormalTok{*}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{));}\FloatTok{1}\NormalTok{];}

\NormalTok{E4 = }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{1}\NormalTok{)),}\FloatTok{1}\NormalTok{),B) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{1}\NormalTok{)),-}\FloatTok{1}\NormalTok{),B');}		
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E4 =
## 
##    2  -1   0  -1   0   0   0   0   0   0   0   0
##   -1   2   2   3   0   0   0   0   0   0   0   0
##    0   2   4  -2   0  -1   0   0   0   0   0   0
##   -1   3  -2   4   2   3   0   0   0   0   0   0
##    0   0   0   2   4  -2   0  -1   0   0   0   0
##    0   0  -1   3  -2   4   2   3   0   0   0   0
##    0   0   0   0   0   2   4  -2   0  -1   0   0
##    0   0   0   0  -1   3  -2   4   2   3   0   0
##    0   0   0   0   0   0   0   2   4  -2   0  -1
##    0   0   0   0   0   0  -1   3  -2   4   2   3
##    0   0   0   0   0   0   0   0   0   2   2  -1
##    0   0   0   0   0   0   0   0  -1   3  -1   2
\end{verbatim}
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{E5=}\FunctionTok{kron}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),}\FloatTok{2}\NormalTok{),B') +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),-}\FloatTok{2}\NormalTok{),B);}		
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E5 =
## 
##    2  -1   0   0   0   2   0   0   0   0   0   0
##   -1   2   0   0  -1   3   0   0   0   0   0   0
##    0   0   2  -1   0   0   0   2   0   0   0   0
##    0   0  -1   2   0   0  -1   3   0   0   0   0
##    0  -1   0   0   2  -1   0   0   0   2   0   0
##    2   3   0   0  -1   2   0   0  -1   3   0   0
##    0   0   0  -1   0   0   2  -1   0   0   0   2
##    0   0   2   3   0   0  -1   2   0   0  -1   3
##    0   0   0   0   0  -1   0   0   2  -1   0   0
##    0   0   0   0   2   3   0   0  -1   2   0   0
##    0   0   0   0   0   0   0  -1   0   0   2  -1
##    0   0   0   0   0   0   2   3   0   0  -1   2
\end{verbatim}
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{v = [}\FloatTok{1}\NormalTok{;}\FunctionTok{zeros}\NormalTok{(n-}\FloatTok{2}\NormalTok{,}\FloatTok{1}\NormalTok{);}\FloatTok{1}\NormalTok{];}
\NormalTok{v1 = [}\FloatTok{0}\NormalTok{;}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{));}\FloatTok{0}\NormalTok{];}

\NormalTok{E6 = }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),C)+ }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v1),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),}\FloatTok{2}\NormalTok{),}\FloatTok{3}\NormalTok{*B') +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),-}\FloatTok{2}\NormalTok{),}\FloatTok{2}\NormalTok{*B) +\textbackslash{}}
\NormalTok{flip(}\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v), flip(}\FunctionTok{eye}\NormalTok{(}\FloatTok{2}\NormalTok{))));}		
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E6 =
## 
##    1   1   0   0   0   6   0   0   0   0   1   0
##    1   2   0   0  -3   9   0   0   0   0   0   1
##    0   0   2  -1   0   0   0   6   0   0   0   0
##    0   0  -1   2   0   0  -3   9   0   0   0   0
##    0  -2   0   0   2  -1   0   0   0   6   0   0
##    4   6   0   0  -1   2   0   0  -3   9   0   0
##    0   0   0  -2   0   0   2  -1   0   0   0   6
##    0   0   4   6   0   0  -1   2   0   0  -3   9
##    0   0   0   0   0  -2   0   0   2  -1   0   0
##    0   0   0   0   4   6   0   0  -1   2   0   0
##    1   0   0   0   0   0   0  -2   0   0   1   1
##    0   1   0   0   0   0   4   6   0   0   1   2
\end{verbatim}
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{v=[}\FloatTok{1}\NormalTok{;}\FunctionTok{zeros}\NormalTok{(n-}\FloatTok{2}\NormalTok{,}\FloatTok{1}\NormalTok{);}\FloatTok{1}\NormalTok{];}
\NormalTok{v1=[}\FloatTok{0}\NormalTok{;}\FloatTok{1}\NormalTok{;}\FunctionTok{zeros}\NormalTok{(n-}\FloatTok{4}\NormalTok{,}\FloatTok{1}\NormalTok{);}\FloatTok{1}\NormalTok{;}\FloatTok{0}\NormalTok{];}
\NormalTok{v2=[}\FloatTok{0}\NormalTok{;}\FloatTok{0}\NormalTok{;}\FloatTok{2}\NormalTok{*}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{4}\NormalTok{));}\FloatTok{0}\NormalTok{;}\FloatTok{0}\NormalTok{];}

\NormalTok{E7=}\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v1),B) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v2),B) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),}\FloatTok{2}\NormalTok{),C) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),-}\FloatTok{2}\NormalTok{),C');}		
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E7 =
## 
##    2  -1   0   0   1   1   0   0   0   0   0   0
##   -1   2   0   0   1   2   0   0   0   0   0   0
##    0   0   0  -1   0   0   1   1   0   0   0   0
##    0   0   2   3   0   0   1   2   0   0   0   0
##    1   1   0   0   0  -2   0   0   1   1   0   0
##    1   2   0   0   4   6   0   0   1   2   0   0
##    0   0   1   1   0   0   0  -2   0   0   1   1
##    0   0   1   2   0   0   4   6   0   0   1   2
##    0   0   0   0   1   1   0   0   0  -1   0   0
##    0   0   0   0   1   2   0   0   2   3   0   0
##    0   0   0   0   0   0   1   1   0   0   2  -1
##    0   0   0   0   0   0   1   2   0   0  -1   2
\end{verbatim}
\end{samepage}

\begin{samepage}
\begin{Shaded}
	\begin{Highlighting}[]
\NormalTok{v=[}\FloatTok{1}\NormalTok{;}\FunctionTok{zeros}\NormalTok{(n-}\FloatTok{2}\NormalTok{,}\FloatTok{1}\NormalTok{);}\FloatTok{1}\NormalTok{];}
\NormalTok{v1=[}\FloatTok{0}\NormalTok{;}\FloatTok{2}\NormalTok{;}\FunctionTok{zeros}\NormalTok{(n-}\FloatTok{4}\NormalTok{,}\FloatTok{1}\NormalTok{);}\FloatTok{2}\NormalTok{;}\FloatTok{0}\NormalTok{];}
\NormalTok{v2=[}\FloatTok{0}\NormalTok{;}\FloatTok{0}\NormalTok{;}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{4}\NormalTok{));}\FloatTok{0}\NormalTok{;}\FloatTok{0}\NormalTok{];}

\NormalTok{E8=}\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),A) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v1),B) + }\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v2),C) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),}\FloatTok{2}\NormalTok{),}\FunctionTok{eye}\NormalTok{(}\FloatTok{2}\NormalTok{)) +\textbackslash{}}
\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{diag}\NormalTok{(}\FunctionTok{eye}\NormalTok{(n-}\FloatTok{2}\NormalTok{)),-}\FloatTok{2}\NormalTok{),}\FunctionTok{eye}\NormalTok{(}\FloatTok{2}\NormalTok{))+\textbackslash{}}
\NormalTok{flip(}\FunctionTok{kron}\NormalTok{(}\FunctionTok{diag}\NormalTok{(v),flip(A)));}		
	\end{Highlighting}
\end{Shaded}
\end{samepage}

\begin{samepage}
\begin{verbatim}
## E8 =
## 
##    2  -1   0   0   1   0   0   0   0   0   2  -1
##   -1   2   0   0   0   1   0   0   0   0  -1   2
##    0   0   0  -2   0   0   1   0   0   0   0   0
##    0   0   4   6   0   0   0   1   0   0   0   0
##    1   0   0   0   1   1   0   0   1   0   0   0
##    0   1   0   0   1   2   0   0   0   1   0   0
##    0   0   1   0   0   0   1   1   0   0   1   0
##    0   0   0   1   0   0   1   2   0   0   0   1
##    0   0   0   0   1   0   0   0   0  -2   0   0
##    0   0   0   0   0   1   0   0   4   6   0   0
##    2  -1   0   0   0   0   1   0   0   0   2  -1
##   -1   2   0   0   0   0   0   1   0   0  -1   2
\end{verbatim}
\end{samepage}
