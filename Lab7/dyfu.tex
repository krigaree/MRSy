\section{Schematy różnicowe dla zadań dyfuzyjnych}

Będziemy korzystać z równania:

\[
\begin{cases}
\vspace{0.1cm} 
\hspace{0,1cm} \dfrac{\delta \psi}{\delta t} = D\dfrac{\delta^2 \psi}{\delta x^2} \hspace{1cm}, \Omega = [0,L]x[0,\infty] \\
\vspace{0.1cm}
\hspace{0,1cm}\psi_{(x,t)}|_{x=0} = 0 \hspace{0.8cm},t>0 \\
\vspace{0.1cm} 
\hspace{0,1cm}\psi_{(x,t)}|_{x=L} = 0 \hspace{0.7cm},t>0 \\
\vspace{0.1cm} 
\hspace{0,1cm}\psi_{(x,t)}|_{t=0} = \varphi(x) \hspace{0.3cm},x\in[0,L]
\end{cases}
\]

\subsection{Cel ćwiczenia}

Naszym zadaniem było stworzenie algorytmu rozwiązującego następujące równanie:

\[
\begin{cases}
\vspace{0.1cm} 
\hspace{0,1cm} \dfrac{\delta \psi}{\delta t} = D\dfrac{\delta^2 \psi}{\delta x^2} \\
\vspace{0.1cm}
\hspace{0,1cm}\psi|_{x=0} = 0 \\
\vspace{0.1cm} 
\hspace{0,1cm}\psi|_{x=L} = 0 \\
\vspace{0.1cm} 
\hspace{0,1cm}\psi|_{t=0} = sin(\frac{\pi x}{2})
\end{cases}
\]

, gdzie:

$\Omega = [0,2]x[0,1]$
\newline
$D=1$
\newline
\vspace{0.2cm}
$\psi_{analityczna}=\psi(x,t)=sin\Big(\dfrac{\pi x}{2}\Big)e^{-\Big(\dfrac{\pi^2 t}{4}\Big)}$

\subsection{Schemat FTCS}

FTCS (ang. Forward Time Central Space) czyli schemat "w przód":

$$\dfrac{\delta \psi}{\delta t} = D\dfrac{\delta^2 \psi}{\delta x^2}$$

Dla lewej strony równania zastosujemy schemat "w przód", natomiast dla prawej schemat centralny.

Mamy więc:

$$\dfrac{\psi^{(n+1)}_{i}-\psi^n_{i}}{\Delta t}=D\dfrac{\psi^{n}_{i+1}-2\psi^n_{i}+\psi^n_{i-1}}{\Delta x^2}$$

Stąd:

$$\psi^{(n+1)}_{i}=\dfrac{D\Delta t}{\Delta x^2}\Big(\psi^{n}_{i+1}-2\psi^{n}_{i}+\psi^{n}_{i-1}\Big)+\psi^{n}_{i} + O(\Delta t)+O(\Delta x^2)$$

Jest to schemat jawny, warunkowo stabilny, a więc parametry siatki muszą zostać dobrane we właściwy sposób.

Warunkiem stabilności dla takiego zadania jest następująca relcja:

$$\dfrac{D\Delta t}{\Delta x^2}\le \dfrac{1}{2}$$
\newpage
\subsubsection{Algorytm}

\input{Lab7/ftcs}
\newpage
\subsubsection{Wykresy}

Dla n = 5:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/ftcs/5.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 80 $

Czas wykonywania algorytmu $ = 0.102 s$

Dla n = 15:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/ftcs/15.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 405 $

Czas wykonywania algorytmu $ = 0.163 s$

\newpage

Dla n = 30:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/ftcs/30.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 4205 $

Czas wykonywania algorytmu $ = 0.472 s$
\newpage
\subsection{Schemat BTCS}
BTCS (ang. Backward Time Central Space) czyli schemat "w tył":

$$\dfrac{\delta \psi}{\delta t} = D\dfrac{\delta^2 \psi}{\delta x^2}$$

Dla lewej strony równania zastosujemy schemat "w tył", natomiast dla prawej schemat centralny.

Mamy więc:

$$\dfrac{\psi^{(n+1)}_{i}-\psi^n_{i}}{\Delta t}=D\dfrac{\psi^{n}_{i+1}-2\psi^n_{i}+\psi^n_{i-1}}{\Delta x^2}$$

Stąd:

$$-\psi^{(n+1)}_{i+1} + \left(2+\dfrac{\Delta x^2}{D \Delta t}\right) \psi^{(n+1)}_{i} -\psi^{(n+1)}_{i-1} =\dfrac{\Delta x^2}{D\Delta t}\psi^{n}_{i}$$

Jest to schemat jawny, bezwzględnie stabilny. 

Z powyższego równania otrzymujemy liniowy układ równań algebraicznych, a więc w każdej iteracji czasowej należy rozwiązać pewien układ równań liniowych.
\newpage
\subsubsection{Algorytm}
\input{Lab7/btcs}
\newpage
\subsubsection{Wykresy}

Dla n = 5:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/btcs/5.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 80 $

Czas wykonywania algorytmu $ = 0.105 s$

Dla n = 15:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/btcs/15.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 980 $

Czas wykonywania algorytmu $ = 0.131 s$

\newpage

Dla n = 30:

\begin{figure}[!ht]
	\begin{center}
		\includegraphics[width=0.78\textwidth]{Lab7/charts/btcs/30.png}
	\end{center}
\end{figure}

Liczba wykonanych iteracji $ = 4205 $

Czas wykonywania algorytmu $ = 0.254 s$
\newpage

\newpage
\subsection{Schemat Cranka-Nicolson}
%TODO
\newpage
\subsubsection{Algorytm}
\input{Lab7/cn}
\newpage
\subsubsection{Wykresy}
\newpage
\subsection{Schemat DuForta-Frankle}
Schemat DuForta-Frankle dla równań dyfuzyjnych postaci:

$$\dfrac{\delta \psi}{\delta t} = D\dfrac{\delta^2 \psi}{\delta x^2}$$

Dla obu stron powyższego równania stosuje się schemat centralny.

Mamy więc:

$$\dfrac{\psi^{(n+1)}_{i}-\psi^{n-1}_{i}}{2\Delta t}=D\dfrac{\psi^{n}_{i+1}- \left( \psi^{(n+1)}_{i} + \psi^{(n-1)}_{i} \right)+\psi^n_{i-1}}{\Delta x^2}$$

Stąd:

$$\psi^{(n+1)}_{i} \left(\dfrac{1}{2 \Delta t} + \dfrac{D}{\Delta x^2}\right)= \dfrac{D}{\Delta x^2} \left( \psi^{n}_{i+1} + \psi^{n}_{i-1} \right) - \psi^{(n-1)}_{i} \left( \dfrac{D}{\Delta x^2} + \dfrac{1}{2\Delta t} \right) $$

Jest to schemat jawny, bezwzględnie stabilny. 

Wadą tej metody jest powstawanie oscylacyjnych rozwiązań dla dużych kroków czasowych, co wpływa na jakość rozwiązania.

Jest to schemat trójpoziomowy, a więc przedstawimy dwa sposoby rozwiązania tego problemu:
\begin{itemize}
	\item skopiujemy warunek początkowy na dwa poziomy
	\item I poziom nieznany zbudujemy za pomocą schematu dwupoziomowego
\end{itemize}

\newpage
\subsubsection{Algorytm}
1)
\input{Lab7/d_f}
\newpage
2)
\input{Lab7/d_f_2}
\newpage
\subsubsection{Wykresy}
\newpage
\subsection{Schemat Richtmyera-Morton}
\newpage
\subsubsection{Algorytm}
1)
\input{Lab7/R_M}
\newpage
2)
\input{Lab7/R_M_B}
\newpage
\subsubsection{Wykresy}
\newpage
